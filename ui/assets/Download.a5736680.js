import{y as H,av as de,ax as ce,c as i,h as k,J as me,g as j,aA as $e,aB as Ce,u as Te,aG as Qe,aH as Pe,aI as Be,r as Q,D as Oe,E as De,aJ as Ee,aK as Ne,aL as Ie,w as X,l as G,aM as K,aN as U,N as ze,aj as Le,n as Ae,X as v,Y as y,Z as m,f as s,a3 as q,aa as I,ag as w,$ as z,a0 as x,a7 as L,ai as He,F as je,ab as Y,ao as Me}from"./index.e7caaa41.js";import{Q as Fe,a as Re}from"./QList.bf00bc68.js";import{Q as Ve}from"./QPage.f5f5ec40.js";import{b as We,c as A,Q as Z,d as C,n as ee,a as T,s as te}from"./QChip.7e8829fd.js";import{l as Je}from"./index.a1ffc747.js";import{u as Xe,v as ae,a as Ge,p as oe,b as Ke,c as Ue,r as le,s as Ye,d as ne,e as Ze}from"./position-engine.e7b42f2c.js";const et=["text","rect","circle","QBtn","QBadge","QChip","QToolbar","QCheckbox","QRadio","QToggle","QSlider","QRange","QInput","QAvatar"],tt=["wave","pulse","pulse-x","pulse-y","fade","blink","none"];var se=H({name:"QSkeleton",props:{...de,tag:{type:String,default:"div"},type:{type:String,validator:e=>et.includes(e),default:"rect"},animation:{type:String,validator:e=>tt.includes(e),default:"wave"},animationSpeed:{type:[String,Number],default:1500},square:Boolean,bordered:Boolean,size:String,width:String,height:String},setup(e,{slots:r}){const n=j(),l=ce(e,n.proxy.$q),c=i(()=>{const t=e.size!==void 0?[e.size,e.size]:[e.width,e.height];return{"--q-skeleton-speed":`${e.animationSpeed}ms`,width:t[0],height:t[1]}}),u=i(()=>`q-skeleton q-skeleton--${l.value===!0?"dark":"light"} q-skeleton--type-${e.type}`+(e.animation!=="none"?` q-skeleton--anim q-skeleton--anim-${e.animation}`:"")+(e.square===!0?" q-skeleton--square":"")+(e.bordered===!0?" q-skeleton--bordered":""));return()=>k(e.tag,{class:u.value,style:c.value},me(r.default))}});const at={xs:2,sm:4,md:6,lg:10,xl:14};function re(e,r,n){return{transform:r===!0?`translateX(${n.lang.rtl===!0?"-":""}100%) scale3d(${-e},1,1)`:`scale3d(${e},1,1)`}}var ot=H({name:"QLinearProgress",props:{...de,...$e,value:{type:Number,default:0},buffer:Number,color:String,trackColor:String,reverse:Boolean,stripe:Boolean,indeterminate:Boolean,query:Boolean,rounded:Boolean,animationSpeed:{type:[String,Number],default:2100},instantFeedback:Boolean},setup(e,{slots:r}){const{proxy:n}=j(),l=ce(e,n.$q),c=Ce(e,at),u=i(()=>e.indeterminate===!0||e.query===!0),t=i(()=>e.reverse!==e.query),a=i(()=>({...c.value!==null?c.value:{},"--q-linear-progress-speed":`${e.animationSpeed}ms`})),o=i(()=>"q-linear-progress"+(e.color!==void 0?` text-${e.color}`:"")+(e.reverse===!0||e.query===!0?" q-linear-progress--reverse":"")+(e.rounded===!0?" rounded-borders":"")),g=i(()=>re(e.buffer!==void 0?e.buffer:1,t.value,n.$q)),_=i(()=>`with${e.instantFeedback===!0?"out":""}-transition`),P=i(()=>`q-linear-progress__track absolute-full q-linear-progress__track--${_.value} q-linear-progress__track--${l.value===!0?"dark":"light"}`+(e.trackColor!==void 0?` bg-${e.trackColor}`:"")),B=i(()=>re(u.value===!0?1:e.value,t.value,n.$q)),O=i(()=>`q-linear-progress__model absolute-full q-linear-progress__model--${_.value} q-linear-progress__model--${u.value===!0?"in":""}determinate`),D=i(()=>({width:`${e.value*100}%`})),b=i(()=>`q-linear-progress__stripe absolute-${e.reverse===!0?"right":"left"} q-linear-progress__stripe--${_.value}`);return()=>{const $=[k("div",{class:P.value,style:g.value}),k("div",{class:O.value,style:B.value})];return e.stripe===!0&&u.value===!1&&$.push(k("div",{class:b.value,style:D.value})),k("div",{class:o.value,style:a.value,role:"progressbar","aria-valuemin":0,"aria-valuemax":1,"aria-valuenow":e.indeterminate===!0?void 0:e.value},Te(r.default,$))}}}),ie=H({name:"QTooltip",inheritAttrs:!1,props:{...Xe,...Qe,...Pe,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null},transitionShow:{default:"jump-down"},transitionHide:{default:"jump-up"},anchor:{type:String,default:"bottom middle",validator:ae},self:{type:String,default:"top middle",validator:ae},offset:{type:Array,default:()=>[14,14],validator:Ge},scrollTarget:{default:void 0},delay:{type:Number,default:0},hideDelay:{type:Number,default:0},persistent:Boolean},emits:[...Be],setup(e,{slots:r,emit:n,attrs:l}){let c,u;const t=j(),{proxy:{$q:a}}=t,o=Q(null),g=Q(!1),_=i(()=>oe(e.anchor,a.lang.rtl)),P=i(()=>oe(e.self,a.lang.rtl)),B=i(()=>e.persistent!==!0),{registerTick:O,removeTick:D}=Oe(),{registerTimeout:b}=De(),{transitionProps:$,transitionStyle:ve}=Ee(e),{localScrollTarget:M,changeScrollEvent:fe,unconfigureScrollTarget:ge}=Ke(e,W),{anchorEl:f,canShow:he,anchorEvents:S}=Ue({showing:g,configureAnchorEl:pe}),{show:ye,hide:E}=Ne({showing:g,canShow:he,handleShow:be,handleHide:we,hideOnRouteChange:B,processOnMount:!0});Object.assign(S,{delayShow:_e,delayHide:Se});const{showPortal:F,hidePortal:R,renderPortal:ke}=Ie(t,o,xe,"tooltip");if(a.platform.is.mobile===!0){const d={anchorEl:f,innerRef:o,onClickOutside(h){return E(h),h.target.classList.contains("q-dialog__backdrop")&&Ae(h),!0}},N=i(()=>e.modelValue===null&&e.persistent!==!0&&g.value===!0);X(N,h=>{(h===!0?Ze:le)(d)}),G(()=>{le(d)})}function be(d){F(),O(()=>{u=new MutationObserver(()=>p()),u.observe(o.value,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),p(),W()}),c===void 0&&(c=X(()=>a.screen.width+"|"+a.screen.height+"|"+e.self+"|"+e.anchor+"|"+a.lang.rtl,p)),b(()=>{F(!0),n("show",d)},e.transitionDuration)}function we(d){D(),R(),V(),b(()=>{R(!0),n("hide",d)},e.transitionDuration)}function V(){u!==void 0&&(u.disconnect(),u=void 0),c!==void 0&&(c(),c=void 0),ge(),K(S,"tooltipTemp")}function p(){Ye({targetEl:o.value,offset:e.offset,anchorEl:f.value,anchorOrigin:_.value,selfOrigin:P.value,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function _e(d){if(a.platform.is.mobile===!0){ne(),document.body.classList.add("non-selectable");const N=f.value,h=["touchmove","touchcancel","touchend","click"].map(J=>[N,J,"delayHide","passiveCapture"]);U(S,"tooltipTemp",h)}b(()=>{ye(d)},e.delay)}function Se(d){a.platform.is.mobile===!0&&(K(S,"tooltipTemp"),ne(),setTimeout(()=>{document.body.classList.remove("non-selectable")},10)),b(()=>{E(d)},e.hideDelay)}function pe(){if(e.noParentEvent===!0||f.value===null)return;const d=a.platform.is.mobile===!0?[[f.value,"touchstart","delayShow","passive"]]:[[f.value,"mouseenter","delayShow","passive"],[f.value,"mouseleave","delayHide","passive"]];U(S,"anchor",d)}function W(){if(f.value!==null||e.scrollTarget!==void 0){M.value=ze(f.value,e.scrollTarget);const d=e.noParentEvent===!0?p:E;fe(M.value,d)}}function qe(){return g.value===!0?k("div",{...l,ref:o,class:["q-tooltip q-tooltip--style q-position-engine no-pointer-events",l.class],style:[l.style,ve.value],role:"tooltip"},me(r.default)):null}function xe(){return k(Le,$.value,qe)}return G(V),Object.assign(t.proxy,{updatePosition:p}),ke}});const lt={class:"text-weight-medium"},nt={class:"text-grey-8"},st={class:"text-grey-8 q-gutter-sm q-pt-sm text-right"},ue=Object.assign({name:"ItemCard"},{__name:"ItemCard",props:{name:{type:String,required:!0},caption:{type:String,default:""},progress:{type:Number,default:60},cover:{type:String,default:"#"},state:{type:Number,default:0},download_path:{type:String,default:""},download_error:{type:String,default:""}},setup(e){return(r,n)=>(v(),y(We,{clickable:"",style:{width:"100%"}},{default:m(()=>[s(A,{avatar:"",top:""},{default:m(()=>[s(Fe,{src:e.cover,ratio:16/9,width:"120px"},null,8,["src"])]),_:1}),s(A,{top:""},{default:m(()=>[s(Z,{lines:"1"},{default:m(()=>[q("span",lt,I(e.name),1),e.state===30?(v(),y(C,{key:0,color:"negative","text-color":"white",icon:"ion-ios-information-circle",label:"\u4E0B\u8F7D\u5931\u8D25",dense:""})):w("",!0),e.state===20?(v(),y(C,{key:1,color:"positive","text-color":"white",icon:"ion-ios-checkmark-circle",label:"\u4E0B\u8F7D\u6210\u529F",dense:""})):w("",!0),e.state===10?(v(),y(C,{key:2,color:"primary","text-color":"white",icon:"ion-ios-cloud-download",label:"\u4E0B\u8F7D\u4E2D",dense:""})):w("",!0),e.state===0?(v(),y(C,{key:3,"text-color":"white",icon:"ion-ios-alarm",label:"\u7B49\u5F85\u4E0B\u8F7D",dense:""})):w("",!0)]),_:1}),s(Z,{caption:"",class:"no-wrap"},{default:m(()=>[z(I(e.caption)+" ",1),s(ot,{value:e.progress*.01,stripe:"",rounded:"",size:"20px",color:"primary"},null,8,["value"]),q("span",nt,"\u4E0B\u8F7D\u4F4D\u7F6E\uFF1A"+I(e.download_path),1)]),_:1})]),_:1}),s(A,{side:""},{default:m(()=>[q("div",st,[s(x,{outline:"",flat:"",dense:"",icon:"ion-ios-trash",color:"gray",onClick:n[0]||(n[0]=l=>r.$emit("delete"))},{default:m(()=>[s(ie,null,{default:m(()=>[z("\u5220\u9664\u4EFB\u52A1")]),_:1})]),_:1}),s(x,{outline:"",flat:"",dense:"",icon:"ion-ios-refresh",color:"gray",onClick:n[1]||(n[1]=l=>r.$emit("delete"))},{default:m(()=>[s(ie,null,{default:m(()=>[z("\u91CD\u8BD5\u4EFB\u52A1")]),_:1})]),_:1})])]),_:1})]),_:1}))}}),rt={style:{"border-radius":"10px"}},it={class:"q-mt-md q-gutter-sm"},ut={key:0,class:"col q-pa-sm q-gutter-sm"},dt={key:1,class:"q-pa-md text-center text-grey-8"},yt=Object.assign({name:"Download",components:{ItemCard:ue}},{__name:"Download",setup(e){const r=Je("/download");let n=Q(!1);const l=Q([]),c=()=>{r.emit("list",{},t=>{t.code==="200"?(n.value=!0,l.value=t.data):T(t.msg)})};r.on("download_event",t=>{if(t.code==="200"){console.log(t.data);const a=l.value.findIndex(o=>o.download_id===t.data.download_id);a!==-1?(l.value[a]=t.data,t.data.state===10&&t.data.progress===0&&ee(t.data.source.search.details[0].cover,t.data.download_name+" \u5F00\u59CB\u4E0B\u8F7D","info"),t.data.state===20&&ee(t.data.source.search.details[0].cover,t.data.download_name+" \u4E0B\u8F7D\u6210\u529F","primary")):(l.value=l.value.concat(t.data),l.value=l.value.sort(o=>-o.download_id))}else T(t.msg)}),r.on("delete_event",t=>{t.code==="200"?(l.value=l.value.filter(a=>a.download_id!==t.data.download_id),te(t.msg)):T(t.msg)});const u=t=>{r.emit("clear",{tag:t})};return r.on("message",t=>{t.code==="200"?te(t.msg):T(t.msg)}),r.on("list",t=>{c()}),c(),(t,a)=>(v(),y(Ve,{style:{"max-width":"1000px",margin:"auto"}},{default:m(()=>[q("div",rt,[q("div",it,[s(x,{label:"\u6E05\u9664\u5DF2\u5B8C\u6210",outline:"",color:"primary",onClick:a[0]||(a[0]=o=>u("Finished"))}),s(x,{label:"\u6E05\u9664\u5931\u8D25",outline:"",color:"primary",onClick:a[1]||(a[1]=o=>u("Failed"))}),s(x,{label:"\u6E05\u9664\u672A\u4E0B\u8F7D",outline:"",color:"primary",onClick:a[2]||(a[2]=o=>u("Downloading"))})]),s(Me,{class:"q-mt-md no-box-shadow",bordered:"",style:{"border-radius":"10px"}},{default:m(()=>[s(Re,{class:"flex flex-wrap",bordered:"",separator:""},{default:m(()=>[(v(!0),L(je,null,He(l.value,o=>(v(),y(ue,{name:o.download_name,cover:o.vod_model.vod_pic,progress:o.progress,state:o.state,download_path:o.download_path,download_error:o.error,onDelete:g=>t.$emit("delete",o.download_id),key:o.download_id},null,8,["name","cover","progress","state","download_path","download_error","onDelete"]))),128)),Y(n)?w("",!0):(v(),L("div",ut,[s(se,{height:"60px"}),s(se,{height:"60px"})])),Y(n)&&l.value.length===0?(v(),L("div",dt," \u6CA1\u6709\u4E0B\u8F7D\u8BB0\u5F55 ")):w("",!0)]),_:1})]),_:1})])]),_:1}))}});export{yt as default};
