import{y as I,ah as ce,aj as ve,c as r,h as k,J as me,g as H,u as ge,am as pe,an as Te,aI as Be,aJ as Pe,aK as De,r as $,D as Oe,E as Ne,aL as Ee,aM as Ie,aN as Le,w as U,l as K,aO as X,aP as Z,N as ze,aq as Ae,n as Ve,Z as f,_ as q,$ as m,f as i,a6 as P,aa as G,a1 as A,m as He,ab as Re,aA as C,a2 as D,a7 as je,a8 as N,a3 as E,b as Me,F as Y,ac as Fe,a9 as We}from"./index.615d0a1d.js";import{Q as Je,S as Ue,a as Ke}from"./SearchDetail.aa67cf13.js";import{Q as Xe}from"./QPage.e8019412.js";import{a as Ze,b as V,Q as ee,c as T,l as Ge,n as te,s as B,e as ae}from"./QChip.8a95922f.js";import{u as Ye,v as le,a as et,p as oe,b as tt,c as at,r as ne,s as lt,d as se,e as ot}from"./position-engine.b29a6d3e.js";import"./QToolbar.d337b255.js";import"./plugin-vue_export-helper.21dcd24c.js";const nt=["text","rect","circle","QBtn","QBadge","QChip","QToolbar","QCheckbox","QRadio","QToggle","QSlider","QRange","QInput","QAvatar"],st=["wave","pulse","pulse-x","pulse-y","fade","blink","none"];var ie=I({name:"QSkeleton",props:{...ce,tag:{type:String,default:"div"},type:{type:String,validator:e=>nt.includes(e),default:"rect"},animation:{type:String,validator:e=>st.includes(e),default:"wave"},animationSpeed:{type:[String,Number],default:1500},square:Boolean,bordered:Boolean,size:String,width:String,height:String},setup(e,{slots:n}){const s=H(),d=ve(e,s.proxy.$q),u=r(()=>{const g=e.size!==void 0?[e.size,e.size]:[e.width,e.height];return{"--q-skeleton-speed":`${e.animationSpeed}ms`,width:g[0],height:g[1]}}),c=r(()=>`q-skeleton q-skeleton--${d.value===!0?"dark":"light"} q-skeleton--type-${e.type}`+(e.animation!=="none"?` q-skeleton--anim q-skeleton--anim-${e.animation}`:"")+(e.square===!0?" q-skeleton--square":"")+(e.bordered===!0?" q-skeleton--bordered":""));return()=>k(e.tag,{class:c.value,style:u.value},me(n.default))}});const it=["top","middle","bottom"];var rt=I({name:"QBadge",props:{color:String,textColor:String,floating:Boolean,transparent:Boolean,multiLine:Boolean,outline:Boolean,rounded:Boolean,label:[Number,String],align:{type:String,validator:e=>it.includes(e)}},setup(e,{slots:n}){const s=r(()=>e.align!==void 0?{verticalAlign:e.align}:null),d=r(()=>{const u=e.outline===!0&&e.color||e.textColor;return`q-badge flex inline items-center no-wrap q-badge--${e.multiLine===!0?"multi":"single"}-line`+(e.outline===!0?" q-badge--outline":e.color!==void 0?` bg-${e.color}`:"")+(u!==void 0?` text-${u}`:"")+(e.floating===!0?" q-badge--floating":"")+(e.rounded===!0?" q-badge--rounded":"")+(e.transparent===!0?" q-badge--transparent":"")});return()=>k("div",{class:d.value,style:s.value,role:"status","aria-label":e.label},ge(n.default,e.label!==void 0?[e.label]:[]))}});const ut={xs:2,sm:4,md:6,lg:10,xl:14};function re(e,n,s){return{transform:n===!0?`translateX(${s.lang.rtl===!0?"-":""}100%) scale3d(${-e},1,1)`:`scale3d(${e},1,1)`}}var dt=I({name:"QLinearProgress",props:{...ce,...pe,value:{type:Number,default:0},buffer:Number,color:String,trackColor:String,reverse:Boolean,stripe:Boolean,indeterminate:Boolean,query:Boolean,rounded:Boolean,animationSpeed:{type:[String,Number],default:2100},instantFeedback:Boolean},setup(e,{slots:n}){const{proxy:s}=H(),d=ve(e,s.$q),u=Te(e,ut),c=r(()=>e.indeterminate===!0||e.query===!0),g=r(()=>e.reverse!==e.query),a=r(()=>({...u.value!==null?u.value:{},"--q-linear-progress-speed":`${e.animationSpeed}ms`})),h=r(()=>"q-linear-progress"+(e.color!==void 0?` text-${e.color}`:"")+(e.reverse===!0||e.query===!0?" q-linear-progress--reverse":"")+(e.rounded===!0?" rounded-borders":"")),b=r(()=>re(e.buffer!==void 0?e.buffer:1,g.value,s.$q)),_=r(()=>`with${e.instantFeedback===!0?"out":""}-transition`),S=r(()=>`q-linear-progress__track absolute-full q-linear-progress__track--${_.value} q-linear-progress__track--${d.value===!0?"dark":"light"}`+(e.trackColor!==void 0?` bg-${e.trackColor}`:"")),t=r(()=>re(c.value===!0?1:e.value,g.value,s.$q)),o=r(()=>`q-linear-progress__model absolute-full q-linear-progress__model--${_.value} q-linear-progress__model--${c.value===!0?"in":""}determinate`),l=r(()=>({width:`${e.value*100}%`})),w=r(()=>`q-linear-progress__stripe absolute-${e.reverse===!0?"right":"left"} q-linear-progress__stripe--${_.value}`);return()=>{const O=[k("div",{class:S.value,style:b.value}),k("div",{class:o.value,style:t.value})];return e.stripe===!0&&c.value===!1&&O.push(k("div",{class:w.value,style:l.value})),k("div",{class:h.value,style:a.value,role:"progressbar","aria-valuemin":0,"aria-valuemax":1,"aria-valuenow":e.indeterminate===!0?void 0:e.value},ge(n.default,O))}}}),ue=I({name:"QTooltip",inheritAttrs:!1,props:{...Ye,...Be,...Pe,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null},transitionShow:{default:"jump-down"},transitionHide:{default:"jump-up"},anchor:{type:String,default:"bottom middle",validator:le},self:{type:String,default:"top middle",validator:le},offset:{type:Array,default:()=>[14,14],validator:et},scrollTarget:{default:void 0},delay:{type:Number,default:0},hideDelay:{type:Number,default:0},persistent:Boolean},emits:[...De],setup(e,{slots:n,emit:s,attrs:d}){let u,c;const g=H(),{proxy:{$q:a}}=g,h=$(null),b=$(!1),_=r(()=>oe(e.anchor,a.lang.rtl)),S=r(()=>oe(e.self,a.lang.rtl)),t=r(()=>e.persistent!==!0),{registerTick:o,removeTick:l}=Oe(),{registerTimeout:w}=Ne(),{transitionProps:O,transitionStyle:fe}=Ee(e),{localScrollTarget:R,changeScrollEvent:he,unconfigureScrollTarget:ye}=tt(e,W),{anchorEl:y,canShow:be,anchorEvents:Q}=at({showing:b,configureAnchorEl:$e}),{show:we,hide:L}=Ie({showing:b,canShow:be,handleShow:_e,handleHide:Se,hideOnRouteChange:t,processOnMount:!0});Object.assign(Q,{delayShow:xe,delayHide:qe});const{showPortal:j,hidePortal:M,renderPortal:ke}=Le(g,h,Qe,"tooltip");if(a.platform.is.mobile===!0){const v={anchorEl:y,innerRef:h,onClickOutside(x){return L(x),x.target.classList.contains("q-dialog__backdrop")&&Ve(x),!0}},z=r(()=>e.modelValue===null&&e.persistent!==!0&&b.value===!0);U(z,x=>{(x===!0?ot:ne)(v)}),K(()=>{ne(v)})}function _e(v){j(),o(()=>{c=new MutationObserver(()=>p()),c.observe(h.value,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),p(),W()}),u===void 0&&(u=U(()=>a.screen.width+"|"+a.screen.height+"|"+e.self+"|"+e.anchor+"|"+a.lang.rtl,p)),w(()=>{j(!0),s("show",v)},e.transitionDuration)}function Se(v){l(),M(),F(),w(()=>{M(!0),s("hide",v)},e.transitionDuration)}function F(){c!==void 0&&(c.disconnect(),c=void 0),u!==void 0&&(u(),u=void 0),ye(),X(Q,"tooltipTemp")}function p(){lt({targetEl:h.value,offset:e.offset,anchorEl:y.value,anchorOrigin:_.value,selfOrigin:S.value,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function xe(v){if(a.platform.is.mobile===!0){se(),document.body.classList.add("non-selectable");const z=y.value,x=["touchmove","touchcancel","touchend","click"].map(J=>[z,J,"delayHide","passiveCapture"]);Z(Q,"tooltipTemp",x)}w(()=>{we(v)},e.delay)}function qe(v){a.platform.is.mobile===!0&&(X(Q,"tooltipTemp"),se(),setTimeout(()=>{document.body.classList.remove("non-selectable")},10)),w(()=>{L(v)},e.hideDelay)}function $e(){if(e.noParentEvent===!0||y.value===null)return;const v=a.platform.is.mobile===!0?[[y.value,"touchstart","delayShow","passive"]]:[[y.value,"mouseenter","delayShow","passive"],[y.value,"mouseleave","delayHide","passive"]];Z(Q,"anchor",v)}function W(){if(y.value!==null||e.scrollTarget!==void 0){R.value=ze(y.value,e.scrollTarget);const v=e.noParentEvent===!0?p:L;he(R.value,v)}}function Ce(){return b.value===!0?k("div",{...d,ref:h,class:["q-tooltip q-tooltip--style q-position-engine no-pointer-events",d.class],style:[d.style,fe.value],role:"tooltip"},me(n.default)):null}function Qe(){return k(Ae,O.value,Ce)}return K(F),Object.assign(g.proxy,{updatePosition:p}),ke}});const ct={class:"text-weight-medium"},vt={class:"absolute-full flex flex-center"},mt={class:"text-grey-8 q-gutter-sm q-pt-sm text-right"},de=Object.assign({name:"ItemCard"},{__name:"ItemCard",props:{name:{type:String,required:!0},caption:{type:String,default:""},progress:{type:Number,default:60},cover:{type:String,default:"#"},state:{type:Number,default:0},download_path:{type:String,default:""},download_error:{type:String,default:""},speed_str:{type:String,default:""}},setup(e){return(n,s)=>(f(),q(Ze,{clickable:"",style:{width:"100%"}},{default:m(()=>[i(V,{avatar:"",top:""},{default:m(()=>[i(Je,{src:e.cover,ratio:16/9,width:"120px"},null,8,["src"])]),_:1}),i(V,{top:""},{default:m(()=>[i(ee,{lines:"1"},{default:m(()=>[P("span",ct,G(e.name),1)]),_:1}),i(ee,{caption:"",class:"no-wrap"},{default:m(()=>[A(G(e.caption)+" ",1),i(dt,{value:e.progress*.01,stripe:"",rounded:"",size:"20px",color:"primary"},{default:m(()=>[P("div",vt,[He(i(rt,{color:"white","text-color":"accent",label:e.speed_str},null,8,["label"]),[[Re,e.speed_str&&e.state===10]])])]),_:1},8,["value"]),e.state===30?(f(),q(T,{key:0,color:"negative","text-color":"white",icon:"ion-ios-information-circle",label:"\u4E0B\u8F7D\u5931\u8D25",dense:""})):C("",!0),e.state===20?(f(),q(T,{key:1,color:"positive","text-color":"white",icon:"ion-ios-checkmark-circle",label:"\u4E0B\u8F7D\u6210\u529F",dense:""})):C("",!0),e.state===10?(f(),q(T,{key:2,color:"primary","text-color":"white",icon:"ion-ios-cloud-download",label:"\u4E0B\u8F7D\u4E2D",dense:""})):C("",!0),e.state===15?(f(),q(T,{key:3,color:"orange","text-color":"white",icon:"ion-ios-outlet",label:"\u89C6\u9891\u8F6C\u7801\u4E2D",dense:""})):C("",!0),e.state===0?(f(),q(T,{key:4,"text-color":"white",icon:"ion-ios-alarm",label:"\u7B49\u5F85\u4E0B\u8F7D",dense:""})):C("",!0)]),_:1})]),_:1}),i(V,{side:""},{default:m(()=>[P("div",mt,[i(D,{outline:"",flat:"",dense:"",icon:"ion-ios-trash",color:"gray",onClick:s[0]||(s[0]=d=>n.$emit("delete"))},{default:m(()=>[i(ue,null,{default:m(()=>[A("\u5220\u9664\u4EFB\u52A1")]),_:1})]),_:1}),i(D,{outline:"",flat:"",dense:"",icon:"ion-ios-refresh",color:"gray",onClick:s[1]||(s[1]=d=>n.$emit("retry"))},{default:m(()=>[i(ue,null,{default:m(()=>[A("\u91CD\u8BD5\u4EFB\u52A1")]),_:1})]),_:1})])]),_:1})]),_:1}))}}),gt={style:{"border-radius":"10px"}},ft={class:"q-ma-md q-gutter-sm"},ht={key:0,class:"col q-pa-sm q-gutter-sm"},yt={key:1,class:"q-pa-md text-center text-grey-8"},$t=Object.assign({name:"Download",components:{ItemCard:de}},{__name:"Download",setup(e){const n=Ge("/download");let s=$(!1),d=$(!1),u=$({}),c=$(!1);const g=je(),a=$([]),h=()=>{n.emit("list",{},t=>{t.code==="200"?(s.value=!0,a.value=t.data):B(t.msg)})};n.on("download_event",t=>{if(t.code==="200"){console.log(t.data);const o=a.value.findIndex(l=>l.download_id===t.data.download_id);o!==-1?(a.value[o]=t.data,t.data.state===10&&t.data.progress===0&&te(t.data.vod_model.vod_pic,t.data.download_name+" \u5F00\u59CB\u4E0B\u8F7D","info"),t.data.state===20&&te(t.data.vod_model.vod_pic,t.data.download_name+" \u4E0B\u8F7D\u6210\u529F","primary")):(a.value=a.value.concat(t.data),a.value=a.value.sort(l=>-l.download_id))}else B(t.msg)}),n.on("delete_event",t=>{t.code==="200"?(a.value=a.value.filter(o=>o.download_id!==t.data.download_id),ae(t.msg)):B(t.msg)});const b=t=>{n.emit("delete",{download_id:t})},_=t=>{u.value=a.value.find(o=>o.download_id===t),c.value=!0,g.loading.show(),n.emit("retry_download",{download_id:t,vod:u.value},o=>{c.value=!1,g.loading.hide(),o.code==="200"?(d.value=!0,u.value=o.data):B(o.msg)})},S=t=>{n.emit("clear",{tag:t})};return n.on("message",t=>{t.code==="200"?ae(t.msg):B(t.msg)}),n.on("list",t=>{h()}),h(),(t,o)=>(f(),N(Y,null,[i(Xe,{style:{"max-width":"1000px",margin:"auto"}},{default:m(()=>[P("div",gt,[P("div",ft,[i(D,{label:"\u6E05\u9664\u5DF2\u5B8C\u6210",color:"white",class:"content text-white",onClick:o[0]||(o[0]=l=>S("Finished"))}),i(D,{label:"\u6E05\u9664\u5931\u8D25",color:"white",class:"content text-white",onClick:o[1]||(o[1]=l=>S("Failed"))}),i(D,{label:"\u6E05\u9664\u672A\u4E0B\u8F7D",color:"white",class:"content text-white",onClick:o[2]||(o[2]=l=>S("None"))})]),i(Fe,{class:"q-ma-md no-box-shadow content",bordered:"",style:{"border-radius":"10px"}},{default:m(()=>[i(Ke,{class:"flex flex-wrap",bordered:"",separator:""},{default:m(()=>[(f(!0),N(Y,null,We(a.value,l=>(f(),q(de,{name:l.download_name,cover:l.vod_model.vod_pic,progress:l.progress,state:l.state,download_path:l.download_path,download_error:l.error,speed_str:l.speed_str,onDelete:w=>b(l.download_id),onRetry:w=>_(l.download_id),key:l.download_id},null,8,["name","cover","progress","state","download_path","download_error","speed_str","onDelete","onRetry"]))),128)),E(s)?C("",!0):(f(),N("div",ht,[i(ie,{height:"60px"}),i(ie,{height:"60px"})])),E(s)&&a.value.length===0?(f(),N("div",yt," \u6CA1\u6709\u4E0B\u8F7D\u8BB0\u5F55 ")):C("",!0)]),_:1})]),_:1})])]),_:1}),i(Ue,{modelValue:E(d),"onUpdate:modelValue":o[3]||(o[3]=l=>Me(d)?d.value=l:d=l),vod:E(u)},null,8,["modelValue","vod"])],64))}});export{$t as default};
